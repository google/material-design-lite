---
import Root from "./Root.astro";

interface Link {
  text: string;
  link: string;
  draft?: boolean;
}

const { frontmatter, links, link } = Astro.props as {
  frontmatter: any;
  link: string;
  links: Link[];
};
---

<Root {frontmatter}>
  <div id="root">
    <aside class="left-nav">
      <div class="navigation-drawer">
        <section>
          {
            links.map((item, index) => {
              if (item.draft) {
                return (
                  <div class="list-tile draft">
                    <span class="title">{item.text}</span>
                  </div>
                );
              }
              return (
                <a
                  href={`/${item.link}`}
                  class="nav-link list-tile"
                  data-selected={link === item.link}
                >
                  <span class="title">{item.text}</span>
                </a>
              );
            })
          }
        </section>
      </div>
    </aside>
    <section class="content">
      <div class="article"><slot /></div>
    </section>
  </div>
</Root>

<style>
  @custom-media --nav-breakpoint (max-width: 1200px);

  #root {
    display: flex;
    flex-direction: row;
    width: 100%;
    height: 100%;
  }
  aside {
    height: 100%;
    border-right: 1px solid var(--md-sys-color-outline-variant);
    overflow-y: auto;
  }
  .content {
    flex: 1;
    width: 100%;
    overflow-y: auto;
  }
  .article {
    width: 100%;
    height: 100%;
    padding: 1rem;
    margin: 0 auto;
  }
  .draft {
    color: var(--md-sys-color-on-surface);
    opacity: 0.2;
  }
  .navigation-drawer {
    padding: 0 1rem;
    width: 280px;
  }
  .list-tile {
    padding: 0;
    margin: 0;
  }
  @media (min-width: 860px) {
    .article {
      max-width: 860px;
    }
  }
  @media (--nav-breakpoint) {
    .left-nav {
      display: none;
    }
  }
</style>

<script>
  // Scroll to selected link
  const selected = document.querySelectorAll(".nav-link[data-selected]");
  if (selected) {
    // Animated scroll to selected link
    selected[0].scrollIntoView({
      behavior: "smooth",
      block: "center",
      inline: "center",
    });
  }
</script>
